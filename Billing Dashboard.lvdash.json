{
  "datasets" : [ {
    "name" : "c52751af",
    "displayName" : "job_infra",
    "query" : "WITH\r\nusage_job AS (\r\n    SELECT usage_date, workspace_id, usage_metadata.job_id AS job_id, usage_quantity, sku_name, usage_unit\r\n    FROM system.billing.usage\r\n    WHERE billing_origin_product = 'JOBS'\r\n    AND product_features.is_serverless = FALSE\r\n    AND usage_date BETWEEN :param_date.min AND :param_date.max\r\n    GROUP BY ALL\r\n),\r\nlist_prices AS (\r\n    SELECT\r\n        price_start_time,\r\n        COALESCE(price_end_time, DATE_ADD(CURRENT_DATE, 1)) AS price_end_time,\r\n        sku_name,\r\n        usage_unit,\r\n        pricing.effective_list.default AS pricing\r\n    FROM system.billing.list_prices\r\n    WHERE currency_code = 'USD'\r\n),\r\ndbu AS (\r\n    SELECT u.usage_date, u.workspace_id, u.job_id, '1.DBU' AS meter_category, u.usage_quantity*p.pricing AS cost\r\n    FROM usage_job AS u\r\n    LEFT JOIN list_prices AS p\r\n        ON u.sku_name = p.sku_name\r\n        AND u.usage_unit = p.usage_unit\r\n        AND u.usage_date BETWEEN p.price_start_time AND p.price_end_time\r\n),\r\nazure AS (\r\n    SELECT\r\n        usage_date,\r\n        workspace_id,\r\n        job_id,\r\n        CASE\r\n            WHEN meter_category = 'Virtual Machines' THEN '2.Virtual Machines'\r\n            WHEN meter_category = 'Storage' THEN '3.Storage'\r\n            WHEN meter_category = 'Bandwidth' THEN '4.Bandwidth'\r\n        END AS meter_category,\r\n        cost\r\n    FROM main.billing.azure_cost\r\n    WHERE usage_date BETWEEN :param_date.min AND :param_date.max\r\n)\r\nSELECT * FROM dbu\r\nUNION ALL\r\nSELECT * FROM azure",
    "parameters" : [ {
      "displayName" : "param_date",
      "keyword" : "param_date",
      "dataType" : "DATE",
      "complexType" : "RANGE",
      "defaultSelection" : {
        "range" : {
          "dataType" : "DATE",
          "min" : {
            "value" : "now-1M/M"
          },
          "max" : {
            "value" : "now/M"
          }
        }
      }
    } ]
  }, {
    "name" : "3b712858",
    "displayName" : "select_workspace_id",
    "query" : "SELECT DISTINCT(workspace_id)\r\nFROM system.billing.usage\r\nWHERE usage_date BETWEEN :param_date.min AND :param_date.max",
    "parameters" : [ {
      "displayName" : "param_date",
      "keyword" : "param_date",
      "dataType" : "DATE",
      "complexType" : "RANGE",
      "defaultSelection" : {
        "range" : {
          "dataType" : "DATE",
          "min" : {
            "value" : "now-1y/y"
          },
          "max" : {
            "value" : "now/y"
          }
        }
      }
    } ]
  }, {
    "name" : "f828a60c",
    "displayName" : "overview",
    "query" : "WITH\r\nusage AS (\r\n    SELECT workspace_id, sku_name, usage_unit, usage_date, usage_quantity, billing_origin_product\r\n    FROM system.billing.usage\r\n    WHERE if(:param_workspace_id='<ALL WORKSPACES>', true, workspace_id = :param_workspace_id)\r\n    AND usage_date BETWEEN :param_date.min AND :param_date.max\r\n),\r\nlist_prices AS (\r\n    SELECT\r\n        price_start_time,\r\n        COALESCE(price_end_time, DATE_ADD(CURRENT_DATE, 1)) AS price_end_time,\r\n        sku_name,\r\n        usage_unit,\r\n        pricing.effective_list.default AS pricing\r\n    FROM system.billing.list_prices\r\n    WHERE currency_code = 'USD'\r\n)\r\nSELECT u.workspace_id, u.sku_name, u.usage_date, u.billing_origin_product, u.usage_quantity*p.pricing AS cost\r\nFROM usage AS u\r\nLEFT JOIN list_prices AS p\r\n    ON u.sku_name = p.sku_name\r\n    AND u.usage_unit = p.usage_unit\r\n    AND u.usage_date BETWEEN p.price_start_time AND p.price_end_time\r\n",
    "parameters" : [ {
      "displayName" : "param_date",
      "keyword" : "param_date",
      "dataType" : "DATE",
      "complexType" : "RANGE",
      "defaultSelection" : {
        "range" : {
          "dataType" : "DATE",
          "min" : {
            "value" : "now-1y/y"
          },
          "max" : {
            "value" : "now/y"
          }
        }
      }
    }, {
      "displayName" : "param_workspace_id",
      "keyword" : "param_workspace_id",
      "dataType" : "STRING",
      "defaultSelection" : {
        "values" : {
          "dataType" : "STRING",
          "values" : [ {
            "value" : "<ALL WORKSPACES>"
          } ]
        }
      }
    } ]
  }, {
    "name" : "e8361a4c",
    "displayName" : "forecast",
    "query" : "WITH\r\nusage AS (\r\n    SELECT usage_date, sku_name, usage_unit, usage_quantity\r\n    FROM system.billing.usage\r\n    WHERE usage_date >= '2025-01-01'\r\n),\r\nprices AS (\r\n    SELECT\r\n        price_start_time,\r\n        COALESCE(price_end_time, DATE_ADD(CURRENT_DATE, 1)) AS price_end_time,\r\n        sku_name,\r\n        usage_unit,\r\n        pricing.effective_list.default AS pricing\r\n    FROM system.billing.list_prices\r\n    WHERE currency_code = 'USD'\r\n),\r\ndbu_cost AS (\r\n    SELECT u.usage_date, 'DBU' AS sku, SUM(u.usage_quantity*p.pricing) AS cost\r\n    FROM usage AS u\r\n    LEFT JOIN prices AS p\r\n        ON u.sku_name = p.sku_name\r\n        AND u.usage_unit = p.usage_unit\r\n        AND u.usage_date BETWEEN p.price_start_time AND p.price_end_time\r\n    GROUP BY 1\r\n),\r\nazure_cost AS (\r\n    SELECT usage_date, 'Virtual Machines' AS sku, SUM(cost) AS cost\r\n    FROM main.billing.azure_cost\r\n    WHERE meter_category = 'Virtual Machines'\r\n    AND usage_date >= '2025-01-01'\r\n    GROUP BY 1\r\n)\r\nSELECT *, NULL AS cost_forecast, NULL AS cost_upper, NULL AS cost_lower FROM azure_cost\r\nUNION ALL\r\nSELECT *, NULL AS cost_forecast, NULL AS cost_upper, NULL AS cost_lower FROM dbu_cost\r\nUNION ALL\r\nSELECT usage_date, sku, NULL AS cost, cost_forecast, cost_upper, cost_lower\r\nFROM main.billing.forecast\r\nWHERE usage_date > CURRENT_DATE"
  } ],
  "pages" : [ {
    "name" : "101f5240",
    "displayName" : "Job with Infra",
    "layout" : [ {
      "widget" : {
        "name" : "7461a4d4",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "c52751af",
            "fields" : [ {
              "name" : "meter_category",
              "expression" : "`meter_category`"
            }, {
              "name" : "daily(usage_date)",
              "expression" : "DATE_TRUNC(\"DAY\", `usage_date`)"
            }, {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 3,
          "widgetType" : "bar",
          "encodings" : {
            "x" : {
              "fieldName" : "daily(usage_date)",
              "scale" : {
                "type" : "temporal"
              },
              "axis" : {
                "hideTitle" : true
              },
              "format" : {
                "type" : "date",
                "date" : "locale-short-month",
                "leadingZeros" : true
              },
              "displayName" : "usage_date"
            },
            "y" : {
              "fieldName" : "sum(cost)",
              "scale" : {
                "type" : "quantitative"
              },
              "axis" : {
                "hideTitle" : true
              },
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "displayName" : "Sum of cost"
            },
            "color" : {
              "fieldName" : "meter_category",
              "scale" : {
                "type" : "categorical",
                "mappings" : [ {
                  "value" : "1.DBU",
                  "color" : "#124559"
                }, {
                  "value" : "2.Virtual Machines",
                  "color" : "#598392"
                }, {
                  "value" : "3.Storage",
                  "color" : "#aec3b0"
                }, {
                  "value" : "4.Bandwidth",
                  "color" : "#eff6e0"
                } ]
              },
              "legend" : {
                "hideTitle" : true,
                "position" : "bottom"
              },
              "displayName" : "Component"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Daily Cost Breakdown by Component"
          }
        }
      },
      "position" : {
        "x" : 2,
        "y" : 3,
        "width" : 4,
        "height" : 6
      }
    }, {
      "widget" : {
        "name" : "efd10301",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "c52751af",
            "fields" : [ {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            } ],
            "filters" : [ {
              "expression" : "`meter_category` IN ('1.DBU')"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 2,
          "widgetType" : "counter",
          "encodings" : {
            "value" : {
              "fieldName" : "sum(cost)",
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "style" : {
                "bold" : true
              },
              "displayName" : "Sum of cost"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "DBU Cost"
          }
        }
      },
      "position" : {
        "x" : 0,
        "y" : 1,
        "width" : 2,
        "height" : 2
      }
    }, {
      "widget" : {
        "name" : "5ef2c6eb",
        "queries" : [ {
          "name" : "parameter_dashboards/01f020ddcaef173d83c74386d1319b26/datasets/01f020e35c121776acf407e9343161d3_param_date",
          "query" : {
            "datasetName" : "c52751af",
            "parameters" : [ {
              "name" : "param_date",
              "keyword" : "param_date"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 2,
          "widgetType" : "filter-date-range-picker",
          "encodings" : {
            "fields" : [ {
              "parameterName" : "param_date",
              "queryName" : "parameter_dashboards/01f020ddcaef173d83c74386d1319b26/datasets/01f020e35c121776acf407e9343161d3_param_date"
            } ]
          },
          "selection" : {
            "defaultSelection" : {
              "range" : {
                "dataType" : "DATE",
                "min" : {
                  "value" : "now/y"
                },
                "max" : {
                  "value" : "now/y"
                }
              }
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Date"
          }
        }
      },
      "position" : {
        "x" : 4,
        "y" : 1,
        "width" : 2,
        "height" : 1
      }
    }, {
      "widget" : {
        "name" : "e5450c99",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "c52751af",
            "fields" : [ {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            } ],
            "filters" : [ {
              "expression" : "`meter_category` IN ('2.Virtual Machines', '3.Storage', '4.Bandwidth')"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 2,
          "widgetType" : "counter",
          "encodings" : {
            "value" : {
              "fieldName" : "sum(cost)",
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "style" : {
                "bold" : true
              },
              "displayName" : "Sum of cost"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Infrastructure Cost"
          }
        }
      },
      "position" : {
        "x" : 2,
        "y" : 1,
        "width" : 2,
        "height" : 2
      }
    }, {
      "widget" : {
        "name" : "aec53a72",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "c52751af",
            "fields" : [ {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            }, {
              "name" : "meter_category",
              "expression" : "`meter_category`"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 3,
          "widgetType" : "pie",
          "encodings" : {
            "angle" : {
              "fieldName" : "sum(cost)",
              "scale" : {
                "type" : "quantitative"
              },
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "axis" : {
                "hideTitle" : true
              },
              "displayName" : "Cost"
            },
            "color" : {
              "fieldName" : "meter_category",
              "scale" : {
                "type" : "categorical",
                "mappings" : [ {
                  "value" : "1.DBU",
                  "color" : "#124559"
                }, {
                  "value" : "2.Virtual Machines",
                  "color" : "#598392"
                }, {
                  "value" : "3.Storage",
                  "color" : "#aec3b0"
                }, {
                  "value" : "4.Bandwidth",
                  "color" : "#eff6e0"
                } ]
              },
              "legend" : {
                "hide" : false,
                "hideTitle" : true
              },
              "displayName" : "Component"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Cost Breakdown by Component"
          }
        }
      },
      "position" : {
        "x" : 0,
        "y" : 3,
        "width" : 2,
        "height" : 6
      }
    }, {
      "widget" : {
        "name" : "6107a09f",
        "queries" : [ {
          "name" : "dashboards/01f020ddcaef173d83c74386d1319b26/datasets/01f0298b104413c9af99ea65281cab86_workspace_id",
          "query" : {
            "datasetName" : "c52751af",
            "fields" : [ {
              "name" : "workspace_id",
              "expression" : "`workspace_id`"
            }, {
              "name" : "workspace_id_associativity",
              "expression" : "COUNT_IF(`associative_filter_predicate_group`)"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 2,
          "widgetType" : "filter-single-select",
          "encodings" : {
            "fields" : [ {
              "fieldName" : "workspace_id",
              "displayName" : "workspace_id",
              "queryName" : "dashboards/01f020ddcaef173d83c74386d1319b26/datasets/01f0298b104413c9af99ea65281cab86_workspace_id"
            } ]
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Workspace"
          }
        }
      },
      "position" : {
        "x" : 4,
        "y" : 2,
        "width" : 2,
        "height" : 1
      }
    }, {
      "widget" : {
        "name" : "d124c7a1",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "c52751af",
            "fields" : [ {
              "name" : "workspace_id",
              "expression" : "`workspace_id`"
            }, {
              "name" : "job_id",
              "expression" : "`job_id`"
            }, {
              "name" : "meter_category",
              "expression" : "`meter_category`"
            }, {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            } ],
            "cubeGroupingSets" : {
              "sets" : [ {
                "fieldNames" : [ "workspace_id", "job_id" ]
              }, {
                "fieldNames" : [ "meter_category" ]
              } ]
            },
            "disaggregated" : false,
            "orders" : [ {
              "direction" : "ASC",
              "expression" : "`workspace_id`"
            }, {
              "direction" : "ASC",
              "expression" : "`job_id`"
            }, {
              "direction" : "ASC",
              "expression" : "`meter_category`"
            } ]
          }
        } ],
        "spec" : {
          "version" : 3,
          "widgetType" : "pivot",
          "encodings" : {
            "rows" : [ {
              "fieldName" : "workspace_id",
              "displayTotal" : true,
              "displayName" : "Workspace"
            }, {
              "fieldName" : "job_id",
              "displayTotal" : false,
              "displayName" : "Job"
            } ],
            "columns" : [ {
              "fieldName" : "meter_category",
              "displayTotal" : true,
              "displayName" : "Component"
            } ],
            "cell" : {
              "type" : "multi-cell",
              "fields" : [ {
                "fieldName" : "sum(cost)",
                "cellType" : "text",
                "format" : {
                  "type" : "number-currency",
                  "currencyCode" : "USD",
                  "abbreviation" : "none",
                  "decimalPlaces" : {
                    "type" : "exact",
                    "places" : 2
                  },
                  "hideGroupSeparator" : true
                },
                "contentAlignment" : "center",
                "style" : {
                  "type" : "color-scale",
                  "backgroundColor" : {
                    "scale" : {
                      "type" : "quantitative",
                      "reverse" : false
                    }
                  }
                },
                "displayName" : "Cost"
              } ],
              "width" : 200
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Detailed Cost Breakdown per Job"
          }
        }
      },
      "position" : {
        "x" : 0,
        "y" : 9,
        "width" : 6,
        "height" : 7
      }
    }, {
      "widget" : {
        "name" : "856bad01",
        "textbox_spec" : "## Databricks Classic Jobs Cost by DBU & Infra Component"
      },
      "position" : {
        "x" : 0,
        "y" : 0,
        "width" : 6,
        "height" : 1
      }
    } ],
    "pageType" : "PAGE_TYPE_CANVAS"
  }, {
    "name" : "ef5eb8e5",
    "displayName" : "DBU Overview",
    "layout" : [ {
      "widget" : {
        "name" : "80d6e7a0",
        "queries" : [ {
          "name" : "parameter_dashboards/01f020ddcaef173d83c74386d1319b26/datasets/01f02e4aa4811430bff88de272512d20_param_date",
          "query" : {
            "datasetName" : "3b712858",
            "parameters" : [ {
              "name" : "param_date",
              "keyword" : "param_date"
            } ],
            "disaggregated" : false
          }
        }, {
          "name" : "parameter_dashboards/01f020ddcaef173d83c74386d1319b26/datasets/01f02e4aa481145bbc5880fc3c334f81_param_date",
          "query" : {
            "datasetName" : "f828a60c",
            "parameters" : [ {
              "name" : "param_date",
              "keyword" : "param_date"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 2,
          "widgetType" : "filter-date-range-picker",
          "encodings" : {
            "fields" : [ {
              "parameterName" : "param_date",
              "queryName" : "parameter_dashboards/01f020ddcaef173d83c74386d1319b26/datasets/01f02e4aa4811430bff88de272512d20_param_date"
            }, {
              "parameterName" : "param_date",
              "queryName" : "parameter_dashboards/01f020ddcaef173d83c74386d1319b26/datasets/01f02e4aa481145bbc5880fc3c334f81_param_date"
            } ]
          },
          "selection" : {
            "defaultSelection" : {
              "range" : {
                "dataType" : "DATE",
                "min" : {
                  "value" : "now/y"
                },
                "max" : {
                  "value" : "now/y"
                }
              }
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Date"
          }
        }
      },
      "position" : {
        "x" : 4,
        "y" : 0,
        "width" : 2,
        "height" : 1
      }
    }, {
      "widget" : {
        "name" : "0d9b14f1",
        "queries" : [ {
          "name" : "dashboards/01f020ddcaef173d83c74386d1319b26/datasets/01f020dddcad1ff8a84da86c4e61bf11_workspace_id",
          "query" : {
            "datasetName" : "3b712858",
            "fields" : [ {
              "name" : "workspace_id",
              "expression" : "`workspace_id`"
            }, {
              "name" : "workspace_id_associativity",
              "expression" : "COUNT_IF(`associative_filter_predicate_group`)"
            } ],
            "disaggregated" : false
          }
        }, {
          "name" : "parameter_dashboards/01f020ddcaef173d83c74386d1319b26/datasets/01f020e3326b13c99cd5855f57661079_param_workspace_id",
          "query" : {
            "datasetName" : "f828a60c",
            "parameters" : [ {
              "name" : "param_workspace_id",
              "keyword" : "param_workspace_id"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 2,
          "widgetType" : "filter-single-select",
          "encodings" : {
            "fields" : [ {
              "parameterName" : "param_workspace_id",
              "queryName" : "parameter_dashboards/01f020ddcaef173d83c74386d1319b26/datasets/01f020e3326b13c99cd5855f57661079_param_workspace_id"
            }, {
              "fieldName" : "workspace_id",
              "displayName" : "workspace_id",
              "queryName" : "dashboards/01f020ddcaef173d83c74386d1319b26/datasets/01f020dddcad1ff8a84da86c4e61bf11_workspace_id"
            } ]
          },
          "disallowAll" : false,
          "frame" : {
            "showTitle" : true,
            "title" : "Workspace"
          }
        }
      },
      "position" : {
        "x" : 4,
        "y" : 1,
        "width" : 2,
        "height" : 1
      }
    }, {
      "widget" : {
        "name" : "98136759",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "f828a60c",
            "fields" : [ {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            }, {
              "name" : "workspace_id",
              "expression" : "`workspace_id`"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 3,
          "widgetType" : "pie",
          "encodings" : {
            "angle" : {
              "fieldName" : "sum(cost)",
              "scale" : {
                "type" : "quantitative"
              },
              "axis" : {
                "hideTitle" : true
              },
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "displayName" : "Sum of cost"
            },
            "color" : {
              "fieldName" : "workspace_id",
              "scale" : {
                "type" : "categorical"
              },
              "displayName" : "Workspace"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Proportional Breakdown by Workspace"
          }
        }
      },
      "position" : {
        "x" : 0,
        "y" : 8,
        "width" : 2,
        "height" : 6
      }
    }, {
      "widget" : {
        "name" : "bd4156b2",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "f828a60c",
            "fields" : [ {
              "name" : "billing_origin_product",
              "expression" : "`billing_origin_product`"
            }, {
              "name" : "daily(usage_date)",
              "expression" : "DATE_TRUNC(\"DAY\", `usage_date`)"
            }, {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 3,
          "widgetType" : "bar",
          "encodings" : {
            "x" : {
              "fieldName" : "daily(usage_date)",
              "scale" : {
                "type" : "temporal"
              },
              "axis" : {
                "hideTitle" : true
              },
              "format" : {
                "type" : "date",
                "date" : "locale-short-month",
                "leadingZeros" : true
              },
              "displayName" : "usage_date"
            },
            "y" : {
              "fieldName" : "sum(cost)",
              "scale" : {
                "type" : "quantitative"
              },
              "axis" : {
                "hideTitle" : true
              },
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "displayName" : "Sum of cost"
            },
            "color" : {
              "fieldName" : "billing_origin_product",
              "scale" : {
                "type" : "categorical"
              },
              "legend" : {
                "hideTitle" : true
              },
              "displayName" : "billing_origin_product"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Daily Cost Breakdown by Product"
          }
        }
      },
      "position" : {
        "x" : 0,
        "y" : 2,
        "width" : 6,
        "height" : 6
      }
    }, {
      "widget" : {
        "name" : "f3de67f8",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "f828a60c",
            "fields" : [ {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            }, {
              "name" : "sku_name",
              "expression" : "`sku_name`"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 3,
          "widgetType" : "pie",
          "encodings" : {
            "angle" : {
              "fieldName" : "sum(cost)",
              "scale" : {
                "type" : "quantitative"
              },
              "axis" : {
                "hideTitle" : true
              },
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "displayName" : "Sum of cost"
            },
            "color" : {
              "fieldName" : "sku_name",
              "scale" : {
                "type" : "categorical"
              },
              "legend" : {
                "hideTitle" : true
              },
              "displayName" : "SKU"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Proportional Breakdown by SKU"
          }
        }
      },
      "position" : {
        "x" : 2,
        "y" : 8,
        "width" : 2,
        "height" : 6
      }
    }, {
      "widget" : {
        "name" : "e2bd7694",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "f828a60c",
            "fields" : [ {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            }, {
              "name" : "billing_origin_product",
              "expression" : "`billing_origin_product`"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 3,
          "widgetType" : "pie",
          "encodings" : {
            "angle" : {
              "fieldName" : "sum(cost)",
              "scale" : {
                "type" : "quantitative"
              },
              "axis" : {
                "hideTitle" : true
              },
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "displayName" : "Sum of cost"
            },
            "color" : {
              "fieldName" : "billing_origin_product",
              "scale" : {
                "type" : "categorical"
              },
              "legend" : {
                "hideTitle" : true
              },
              "displayName" : "billing_origin_product"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Proportional Breakdown by Product"
          }
        }
      },
      "position" : {
        "x" : 4,
        "y" : 8,
        "width" : 2,
        "height" : 6
      }
    }, {
      "widget" : {
        "name" : "5432690a",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "f828a60c",
            "fields" : [ {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 2,
          "widgetType" : "counter",
          "encodings" : {
            "value" : {
              "fieldName" : "sum(cost)",
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "displayName" : "Sum of cost"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Total DBU Cost"
          }
        }
      },
      "position" : {
        "x" : 2,
        "y" : 0,
        "width" : 2,
        "height" : 2
      }
    }, {
      "widget" : {
        "name" : "5e277c22",
        "textbox_spec" : "# Databricks DBU Costs"
      },
      "position" : {
        "x" : 0,
        "y" : 0,
        "width" : 2,
        "height" : 2
      }
    } ],
    "pageType" : "PAGE_TYPE_CANVAS"
  }, {
    "name" : "fef11bd1",
    "displayName" : "Forecast",
    "layout" : [ {
      "widget" : {
        "name" : "5e478174",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "e8361a4c",
            "fields" : [ {
              "name" : "weekly(usage_date)",
              "expression" : "DATE_TRUNC(\"WEEK\", `usage_date`)"
            }, {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            }, {
              "name" : "sum(cost_forecast)",
              "expression" : "SUM(`cost_forecast`)"
            }, {
              "name" : "sum(cost_upper)",
              "expression" : "SUM(`cost_upper`)"
            }, {
              "name" : "sum(cost_lower)",
              "expression" : "SUM(`cost_lower`)"
            } ],
            "filters" : [ {
              "expression" : "`sku` IN ('DBU')"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 1,
          "widgetType" : "combo",
          "encodings" : {
            "x" : {
              "fieldName" : "weekly(usage_date)",
              "scale" : {
                "type" : "temporal"
              },
              "axis" : {
                "hideTitle" : true
              },
              "format" : {
                "type" : "date",
                "date" : "locale-short-month",
                "leadingZeros" : true
              },
              "displayName" : "usage_date"
            },
            "color" : {
              "legend" : {
                "position" : "bottom",
                "hideTitle" : true
              }
            },
            "y" : {
              "primary" : {
                "fields" : [ {
                  "fieldName" : "sum(cost)",
                  "displayName" : "Actual Costs"
                }, {
                  "fieldName" : "sum(cost_forecast)",
                  "displayName" : "Forecasted Costs"
                } ]
              },
              "secondary" : {
                "fields" : [ {
                  "fieldName" : "sum(cost_upper)",
                  "displayName" : "Upper bound of the forecasted costs"
                }, {
                  "fieldName" : "sum(cost_lower)",
                  "displayName" : "Lower bound of the forecasted costs"
                } ]
              },
              "scale" : {
                "type" : "quantitative"
              },
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "axis" : {
                "hideTitle" : true
              }
            }
          },
          "frame" : {
            "showDescription" : false,
            "showTitle" : true,
            "title" : "Weekly Comparison of Actual and Forecasted DBU Costs"
          },
          "mark" : {
            "colors" : [ "#ff3621", "#eeede9", "#1b3139", "#1b3139", {
              "themeColorType" : "visualizationColors",
              "position" : 5
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 6
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 7
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 8
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 9
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 10
            } ]
          }
        }
      },
      "position" : {
        "x" : 0,
        "y" : 3,
        "width" : 6,
        "height" : 6
      }
    }, {
      "widget" : {
        "name" : "25ede6ca",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "e8361a4c",
            "fields" : [ {
              "name" : "weekly(usage_date)",
              "expression" : "DATE_TRUNC(\"WEEK\", `usage_date`)"
            }, {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            }, {
              "name" : "sum(cost_forecast)",
              "expression" : "SUM(`cost_forecast`)"
            }, {
              "name" : "sum(cost_upper)",
              "expression" : "SUM(`cost_upper`)"
            }, {
              "name" : "sum(cost_lower)",
              "expression" : "SUM(`cost_lower`)"
            } ],
            "filters" : [ {
              "expression" : "`sku` IN ('Virtual Machines')"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 1,
          "widgetType" : "combo",
          "encodings" : {
            "x" : {
              "fieldName" : "weekly(usage_date)",
              "scale" : {
                "type" : "temporal"
              },
              "format" : {
                "type" : "date",
                "date" : "locale-short-month",
                "leadingZeros" : true
              },
              "displayName" : "usage_date"
            },
            "color" : {
              "legend" : {
                "position" : "bottom",
                "hideTitle" : true
              }
            },
            "y" : {
              "primary" : {
                "fields" : [ {
                  "fieldName" : "sum(cost)",
                  "displayName" : "Actual Costs"
                }, {
                  "fieldName" : "sum(cost_forecast)",
                  "displayName" : "Forecasted Costs"
                } ]
              },
              "secondary" : {
                "fields" : [ {
                  "fieldName" : "sum(cost_upper)",
                  "displayName" : "Upper bound of the forecasted costs"
                }, {
                  "fieldName" : "sum(cost_lower)",
                  "displayName" : "Lower bound of the forecasted costs"
                } ]
              },
              "scale" : {
                "type" : "quantitative"
              },
              "axis" : {
                "hideTitle" : true
              },
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              }
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Weekly Comparison of Actual and Forecasted VM Costs"
          },
          "mark" : {
            "colors" : [ "#ff3621", "#eeede9", "#1b3139", "#1b3139", {
              "themeColorType" : "visualizationColors",
              "position" : 5
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 6
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 7
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 8
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 9
            }, {
              "themeColorType" : "visualizationColors",
              "position" : 10
            } ]
          }
        }
      },
      "position" : {
        "x" : 0,
        "y" : 11,
        "width" : 6,
        "height" : 6
      }
    }, {
      "widget" : {
        "name" : "4187489c",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "e8361a4c",
            "fields" : [ {
              "name" : "sum(cost_forecast)",
              "expression" : "SUM(`cost_forecast`)"
            } ],
            "filters" : [ {
              "expression" : "`sku` IN ('DBU')"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 2,
          "widgetType" : "counter",
          "encodings" : {
            "value" : {
              "fieldName" : "sum(cost_forecast)",
              "style" : {
                "bold" : true
              },
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "none",
                "decimalPlaces" : {
                  "type" : "exact",
                  "places" : 2
                },
                "hideGroupSeparator" : false
              },
              "displayName" : "Sum of cost_forecast"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Total Forecasted DBU Cost for the Next 12 Months"
          }
        }
      },
      "position" : {
        "x" : 3,
        "y" : 1,
        "width" : 3,
        "height" : 2
      }
    }, {
      "widget" : {
        "name" : "be86f48f",
        "textbox_spec" : "## Forecasted Databricks DBU & VM Costs"
      },
      "position" : {
        "x" : 0,
        "y" : 0,
        "width" : 6,
        "height" : 1
      }
    }, {
      "widget" : {
        "name" : "147dc0bf",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "e8361a4c",
            "fields" : [ {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            } ],
            "filters" : [ {
              "expression" : "`sku` IN ('DBU')"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 2,
          "widgetType" : "counter",
          "encodings" : {
            "value" : {
              "fieldName" : "sum(cost)",
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "style" : {
                "bold" : true
              },
              "displayName" : "Sum of cost"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Total DBU Cost Incurred This Year"
          }
        }
      },
      "position" : {
        "x" : 1,
        "y" : 1,
        "width" : 2,
        "height" : 2
      }
    }, {
      "widget" : {
        "name" : "e2cb1c04",
        "textbox_spec" : "# DBU"
      },
      "position" : {
        "x" : 0,
        "y" : 1,
        "width" : 1,
        "height" : 2
      }
    }, {
      "widget" : {
        "name" : "64a1bef9",
        "textbox_spec" : "# VM"
      },
      "position" : {
        "x" : 0,
        "y" : 9,
        "width" : 1,
        "height" : 2
      }
    }, {
      "widget" : {
        "name" : "94743257",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "e8361a4c",
            "fields" : [ {
              "name" : "sum(cost)",
              "expression" : "SUM(`cost`)"
            } ],
            "filters" : [ {
              "expression" : "`sku` IN ('Virtual Machines')"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 2,
          "widgetType" : "counter",
          "encodings" : {
            "value" : {
              "fieldName" : "sum(cost)",
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "compact",
                "decimalPlaces" : {
                  "type" : "max",
                  "places" : 2
                }
              },
              "style" : {
                "bold" : true
              },
              "displayName" : "Sum of cost"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Total VM Cost Incurred This Year"
          }
        }
      },
      "position" : {
        "x" : 1,
        "y" : 9,
        "width" : 2,
        "height" : 2
      }
    }, {
      "widget" : {
        "name" : "dc2cc862",
        "queries" : [ {
          "name" : "main_query",
          "query" : {
            "datasetName" : "e8361a4c",
            "fields" : [ {
              "name" : "sum(cost_forecast)",
              "expression" : "SUM(`cost_forecast`)"
            } ],
            "filters" : [ {
              "expression" : "`sku` IN ('Virtual Machines')"
            } ],
            "disaggregated" : false
          }
        } ],
        "spec" : {
          "version" : 2,
          "widgetType" : "counter",
          "encodings" : {
            "value" : {
              "fieldName" : "sum(cost_forecast)",
              "style" : {
                "bold" : true
              },
              "format" : {
                "type" : "number-currency",
                "currencyCode" : "USD",
                "abbreviation" : "none",
                "decimalPlaces" : {
                  "type" : "exact",
                  "places" : 2
                },
                "hideGroupSeparator" : false
              },
              "displayName" : "Sum of cost_forecast"
            }
          },
          "frame" : {
            "showTitle" : true,
            "title" : "Total Forecasted VM Cost for the Next 12 Months"
          }
        }
      },
      "position" : {
        "x" : 3,
        "y" : 9,
        "width" : 3,
        "height" : 2
      }
    } ],
    "pageType" : "PAGE_TYPE_CANVAS"
  } ]
}